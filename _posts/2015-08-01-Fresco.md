---
layout: post
title: Fresco配置
category : fresco
tagline: "Supporting tagline"
tags : [fresco, android]
---
{% include JB/setup %}
# Fresco初始化配置
### 1. 功能介绍  
##### 1.1 Fresco是一个强大的图片加载组件,具有自动释放内存的功能  
[github地址](https://github.com/facebook/fresco)   [文档地址](http://fresco-cn.org/)
---
<!--break-->
1.Fresco初始化
Fresco提供两个静态初始化方法```initialize(Context context)```和```initialize(Context context, ImagePipelineConfig imagePipelineConfig)```
先来介绍第一种

    /** Initializes Fresco with the default config. */
    public static void initialize(Context context) {
      ImagePipelineFactory.initialize(context);
      initializeDrawee(context);
    }

```ImagePipelineFactory```是一个```ImagePipeline```的工厂,用于创建一个```ImagePipeline```,创建```ImagePipeline```的代码如下:  

    /** Initializes {@link ImagePipelineFactory} with default config. */
    public static void initialize(Context context) {
      initialize(ImagePipelineConfig.newBuilder(context).build());
    }

这个方法初始化了内存缓存```getBitmapMemoryCache()```和硬盘缓存```getMainBufferedDiskCache()```和小图的缓存配置```getSmallImageBufferedDiskCache()```的实例,```imagePipelineConfig```是创建```ImagePipeline```的配置和```NetworkFetcher```的配置,这是一个Builder模式.This should only be done once per process.这是ImagePipelineConfig的解释,每一个进程应该只进行一次操作,
ImagePipelineConfig config = ImagePipelineConfig.newBuilder()  
        .setXXX(xxx)  
        .setYYY(yyy)  
        .build();  
    ImagePipelineFactory factory = new   ImagePipelineFactory(config);  
    ImagePipeline pipeline = factory.getImagePipeline();

    public ImagePipeline getImagePipeline() {
      if (mImagePipeline == null) {
        mImagePipeline =
            new ImagePipeline(
                getProducerSequenceFactory(),
                mConfig.getRequestListeners(),
                mConfig.getIsPrefetchEnabledSupplier(),
                getBitmapMemoryCache(),
                getEncodedMemoryCache(),
                mConfig.getCacheKeyFactory());
      }
      return mImagePipeline;
    }

这个方法是创建```ImagePipeline```的实例,后面在了解```ImagePipeline```的作用.
初始化DraweeView的方法
    private static void initializeDrawee(Context context) {
        sDraweeControllerBuilderSupplier = new PipelineDraweeControllerBuilderSupplier(context);
        SimpleDraweeView.initialize(sDraweeControllerBuilderSupplier);
      }
首先会先初始化一个```PipelineDraweeControllerBuilderSupplier```这个类实现```Supplier```接口

    /
      A class that can supply objects of a single type.  Semantically, this could
      be a factory, generator, builder, closure, or something else entirely. No
      guarantees are implied by this interface.

      @author Harry Heymann
      @since 2.0 (imported from Google Collections Library)
     /
    public interface Supplier<T> {

        Retrieves an instance of the appropriate type. The returned object may or
        may not be a new instance, depending on the implementation.

        @return an instance of the appropriate type
       /
      T get();
    }
这个接口比较简单,只有一个```get()```方法,返回的是这个接口的范型类型,这个类是从google Guava里移植过来的
